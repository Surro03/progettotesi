<!DOCTYPE html>
<html lang="it" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${client} ? 'Aggiungi Cliente' : 'Modifica Utente'">Form Utente</title>
</head>
<body>

<th:block th:with="formAction=${edit}
                     ? @{/buildings/{buildingId}/clients/{clientId}/edit(buildingId=${buildingId}, clientId=${clientId})}
                     : (${client}
                         ? @{/buildings/{buildingId}/clients/add(buildingId=${buildingId})}
                         : @{/user/edit})">

    <form th:action="${formAction}"
          th:object="${registerForm}"
          method="post" autocomplete="on">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

        <table>
            <tr>
                <td><label for="name">Nome:</label></td>
                <td><input id="name" type="text" th:field="*{name}" autocomplete="given-name"
                           placeholder="Mario" required autofocus/></td>
                <td th:if="${#fields.hasErrors('name')}" th:errors="*{name}">Errore nome</td>
            </tr>

            <tr>
                <td><label for="surname">Cognome:</label></td>
                <td><input id="surname" type="text" th:field="*{surname}" autocomplete="family-name"
                           placeholder="Rossi" required/></td>
                <td th:if="${#fields.hasErrors('surname')}" th:errors="*{surname}">Errore cognome</td>
            </tr>

            <tr>
                <td><label for="email">Email:</label></td>
                <td><input id="email" type="email" th:field="*{email}" autocomplete="email"
                           placeholder="mario.rossi@email.com" required/></td>
                <td th:if="${#fields.hasErrors('email')}" th:errors="*{email}">Errore email</td>
            </tr>

            <tr>
                <td><label for="password">Password:</label></td>
                <td>
                    <input id="password" type="password" th:field="*{password}" autocomplete="new-password"
                           th:attr="placeholder=${client} ? 'Inserisci la password' : 'Lascia vuoto per non cambiare',
                                    required=${client}"/>
                </td>
                <td th:if="${#fields.hasErrors('password')}" th:errors="*{password}">Errore password</td>
            </tr>

            <tr>
                <td colspan="3" th:if="${client} and !${edit}">
                    <button type="submit">Aggiungi Cliente</button>
                </td>
                <td colspan="3" th:if="${edit} and ${client}">
                    <button type="submit">Modifica Cliente</button>
                </td>
                <td colspan="3" th:if="${!client}">
                    <button type="submit">Modifica Account</button>
                </td>
            </tr>
        </table>
    </form>
</th:block>

<a th:href="${client}
             ? @{/buildings/{buildingId}(buildingId=${buildingId})}
             : @{/user/details}">
    Annulla
</a>

</body>
</html>
